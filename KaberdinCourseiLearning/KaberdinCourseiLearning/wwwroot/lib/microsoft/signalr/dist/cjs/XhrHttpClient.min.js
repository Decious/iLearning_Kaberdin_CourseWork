"use strict";var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Errors_1=require("./Errors"),HttpClient_1=require("./HttpClient"),ILogger_1=require("./ILogger"),XhrHttpClient=function(n){function t(t){var i=n.call(this)||this;return i.logger=t,i}return __extends(t,n),t.prototype.send=function(n){var t=this;return n.abortSignal&&n.abortSignal.aborted?Promise.reject(new Errors_1.AbortError):n.method?n.url?new Promise(function(i,r){var u=new XMLHttpRequest,f;u.open(n.method,n.url,!0);u.withCredentials=n.withCredentials===undefined?!0:n.withCredentials;u.setRequestHeader("X-Requested-With","XMLHttpRequest");u.setRequestHeader("Content-Type","text/plain;charset=UTF-8");f=n.headers;f&&Object.keys(f).forEach(function(n){u.setRequestHeader(n,f[n])});n.responseType&&(u.responseType=n.responseType);n.abortSignal&&(n.abortSignal.onabort=function(){u.abort();r(new Errors_1.AbortError)});n.timeout&&(u.timeout=n.timeout);u.onload=function(){n.abortSignal&&(n.abortSignal.onabort=null);u.status>=200&&u.status<300?i(new HttpClient_1.HttpResponse(u.status,u.statusText,u.response||u.responseText)):r(new Errors_1.HttpError(u.statusText,u.status))};u.onerror=function(){t.logger.log(ILogger_1.LogLevel.Warning,"Error from HTTP request. "+u.status+": "+u.statusText+".");r(new Errors_1.HttpError(u.statusText,u.status))};u.ontimeout=function(){t.logger.log(ILogger_1.LogLevel.Warning,"Timeout from HTTP request.");r(new Errors_1.TimeoutError)};u.send(n.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(HttpClient_1.HttpClient);exports.XhrHttpClient=XhrHttpClient;